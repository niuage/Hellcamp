<ul id="main-nav" class="clearfix">
  <% ids = @current_rooms.map(&:id) %>
  <% @rooms.each do |room| %>
    <% room_id = room.id %>
    <% path = ((included = ids.include?(room_id)) ? ( (without = ids.reject{|id| id == room_id}).length == 0 ? [room_id] : without ) : (ids + [room_id])).join("-") %>
    <li id="tab_<%= room.name.downcase %>" class="room-tab <%= included ? "selected" : "" %>">
      <%= link_to room.name, rooms_path(path) %>
      <div class="hidden notification"></div>
    </li>
  <% end %>
</ul>